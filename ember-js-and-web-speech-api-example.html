<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Ember.js and the Web Speech API: Example of a Speech Recognition Component</title><meta name="description" content="The article describes the Web Speech API (speech synthesis and speech recognition) using a simple Ember.js component as an example. The component gets the voice input and sends it to your Ember.js app. Also it can speak back what the API has recognized"><link async rel="stylesheet" href="/styles/main.css"><link rel="canonical" href="/ember-js-and-web-speech-api-example.html"><link rel="alternate" type="application/atom+xml" title="JavaScript for Ninja" href=""><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" title="Default" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/monokai_sublime.min.css"><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script async src="//assets.codepen.io/assets/embed/ei.js"></script></head><body><a class="gh-ribbon" href="https://github.com/js-for-ninja/js-for-ninja.github.io.source"><img style="z-index: 100; position: absolute; top: 0; right: 0; border: 0" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a><header class="site-header"><div class="wrapper"><a class="site-title" href="/"><img src="/img/small.png" alt=""></a><nav class="site-nav"><a href="#" class="menu-icon"><svg viewbox="0 0 18 15"><path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"></path><path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"></path><path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"></path></svg></a><div class="trigger"><a class="page-link" href="http://feeds.feedburner.com/JsForNinja">RSS</a> <a class="page-link" href="/about.html">About</a></div></nav></div></header><div class="page-content"><div class="wrapper"><div itemscope itemtype="http://schema.org/Article" class="post"><header class="post-header"><h1 itemprop="name" class="post-title">Ember.js and the Web Speech API: Example of a Speech Recognition Component</h1><p class="post-meta"><span itemprop="datePublished" content="Sun Dec 07 2014 17:00:00 GMT+0100 (CET)">Dec 7, 2014</span> â€¢ <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Oleksii Rudenko</span></span></p></header><article class="post-content"><p>On Friday I&#39;ve stumbled upon a <a href="http://www.smashingmagazine.com/2014/12/05/enhancing-ux-with-the-web-speech-api/">good article</a> about the Web Speech API and I decided that I should play with this API as I&#39;ve never used it before.</p><p>The <a href="https://dvcs.w3.org/hg/speech-api/raw-file/tip/webspeechapi.html#tts-section">Web Speech API</a> is in the Unofficial Draft status and it&#39;s implemented in <a href="http://caniuse.com/#feat=web-speech">Chrome and Safari</a> only. The API consists of two parts: the speech recognition and the speech synthesis.</p><h2>Speech Recognition (speech-to-text)</h2><p>Speech recognition service is provided by the <a href="https://dvcs.w3.org/hg/speech-api/raw-file/tip/webspeechapi.html#speechreco-section">SpeechRecognition</a> interface. In Google Chrome, you&#39;d need to use the prefixed version <code>webkitSpeechRecognition</code>. The basic usage of the API is quite trivial:</p><pre><code class="lang-js">
// creating an instance of SpeechRecognition interface
var recognition = new webkitSpeechRecognition();
recognition.onresult = function(event) {
  // event.results contain the results of recognition
  // each result has the transcript property
  // which is a textual representation of the speech
  if (event.results.length &gt; 0) {
    alert(event.results[0][0].transcript);
  }
}
</code></pre><p>The methods of the <code>webkitSpeechRecognition</code> interface are:</p><ul><li><code>start()</code> - starts the recognition</li><li><code>stop()</code> - stops the recognition</li><li><code>abort()</code> - aborts the recognition immediately</li></ul><p>Three important handlers:</p><ul><li><code>onresult</code> - the recognition API passes the results(both interim and final results) to this handler. The value of the <code>isFinal</code> attribute for final results equals true.</li><li><code>onerror</code> - is called when an error happens.</li><li><code>onend</code> - is called when the recognition ends.</li></ul><p>The <code>webkitSpeechRecognition</code> interface has several interesting parameters:</p><ul><li><code>lang</code> - string, the language used for recognition. If not set, the language of the html document root will be used.</li><li><code>continuous</code> - boolean, it defines how many results are provided. If <code>continuous == false</code>, only one result will be provided. To get more results, the recognition should be started again.</li><li><code>interimResults</code> - boolean, it defines whether interim results are returned. Interim results are not final and may not be accurate.</li></ul><p>More event handlers and methods are <a href="https://dvcs.w3.org/hg/speech-api/raw-file/tip/webspeechapi.html#speechreco-section">here</a>.</p><h2>Speech Synthesis (text-to-speech)</h2><p>Another half of the API provides the text-to-speech feature. It works like this:</p><pre><code class="lang-js">
speechSynthesis.speak(new SpeechSynthesisUtterance(&#39;Javascript for Ninja&#39;));
</code></pre><h2>Ember.js Speech Recognition Component</h2><p>I think that the speech recognition should be disabled by default because it requires an approval by the user and, thus, if it&#39;s activated in the background it may look suspicious to the user.</p><p>But I would like to provide a possibility to use speech recognition, if the user wants to. I see this as a widget with a possibility to activate the speech recognition.</p><p>First, I will write a simple app:</p><pre><code class="lang-js">
App = Ember.Application.create();
App.Router.map(function() {
  // put your routes here
});
App.IndexController = Ember.ObjectController.extend({
  speakBack: &#39;&#39;, // a property to hold the recognized speech
  actions: {
    // this will speak the recognized text
    // using another part of the Web Speech API
    // https://dvcs.w3.org/hg/speech-api/raw-file/tip/webspeechapi.
    speak: function() {
      var utterance = new SpeechSynthesisUtterance(this.get(&#39;speakBack&#39;));
      utterance.onerror = function() {
        console.log(arguments);
      };
      speechSynthesis.speak(utterance);
    },
    onResult: function(result) {
      alert(&#39;Search this: &#39; + result);
      this.set(&#39;speakBack&#39;, result);
    }
  }
});
</code></pre><p>The HTML for the app:</p><pre><code class="lang-html">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;body&gt;
        &lt;script type=&quot;text/x-handlebars&quot;&gt;
            &lt;h2&gt;Voice Control Component Demo&lt;/h2&gt;
            {{outlet}}
        &lt;/script&gt;
        &lt;script type=&quot;text/x-handlebars&quot; data-template-name=&quot;index&quot;&gt;
            &lt;div class=&quot;container-fluid&quot;&gt;
              &lt;div class=&quot;row&quot;&gt;
                &lt;div class=&quot;col-xs-6 col-md-4&quot;&gt;
                  {{voice-control onResult=&quot;onResult&quot;}}
                &lt;/div&gt;
              &lt;/div&gt;
              &lt;br&gt;
              {{#if speakBack}}
                &lt;div class=&quot;row&quot;&gt;
                  &lt;div class=&quot;col-xs-6 col-md-4&quot;&gt;
                    &lt;button class=&quot;btn btn-primary&quot; {{action &#39;speak&#39;}}&gt;
                        Speak Back
                    &lt;/button&gt;
                  &lt;/div&gt;
                &lt;/div&gt;
              {{/if}}
            &lt;/div&gt;
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>Now the implementation of the component to control the Web Speech API:</p><pre><code class="lang-js">
/**
* VoiceControlComponent uses Web Speech API to recognize speech
* Usage:
*   {{voice-control onResult=&quot;onResult&quot;}}
*/
App.VoiceControlComponent = Ember.Component.extend({
  enabled: false, // whether recognition is enabled
  speechRecognition: null, // the instance of webkitSpeechRecognition
  language: &#39;en&#39;, // language to recognise
  startRecognition: function() {
    // prefixed SpeechRecognition object because it only works in Chrome
    var speechRecognition = new webkitSpeechRecognition();
    // not continuous to avoid delays
    speechRecognition.continuous = false;
    // only the final result
    speechRecognition.interimResults = false;
    // the recognition language
    speechRecognition.lang = this.get(&#39;language&#39;);
    // binding various handlers
    speechRecognition.onresult = Ember.run.bind(this, this.onRecoginitionResult);
    speechRecognition.onerror = Ember.run.bind(this, this.onRecognitionError);
    speechRecognition.onend = Ember.run.bind(this, this.onRecognitionEnd);
    // starting the recognition
    speechRecognition.start();
  },
  onRecognitionEnd: function() {
    this.set(&#39;enabled&#39;, false);
  },
  onRecognitionError: function() {
    alert(&#39;Recognition error&#39;);
  },
  /**
  * e is a SpeechRecognitionEvent
  * https://dvcs.w3.org/hg/speech-api/raw-file/tip/webspeechapi.html#speechreco-event
  */
  onRecoginitionResult: function(e) {
    var result = &#39;&#39;;
    var resultNo = 0;
    var alternativeNo = 0;
    // we get the first alternative of the first result
    result = e.results[resultNo][alternativeNo].transcript;
    // report the result to the outside
    this.sendAction(&#39;onResult&#39;, result);
  },
  onEnabledChange: function() {
    if (this.get(&#39;enabled&#39;)) {
      this.startRecognition();
    }
  }.observes(&#39;enabled&#39;),
  actions: {
    toggle: function() {
      this.toggleProperty(&#39;enabled&#39;);
    }
  }
});
</code></pre><p>And a simple template for the component:</p><pre><code class="lang-html">
&lt;!-- VoiceControlComponent&#39;s template --&gt;
&lt;script type=&quot;text/x-handlebars&quot; data-template-name=&quot;components/voice-control&quot;&gt;
    &lt;button class=&quot;btn btn-primary&quot; {{action &#39;toggle&#39;}}&gt;
            &lt;i {{bind-attr class=&quot;:fa :fa-lg enabled:fa-microphone:fa-microphone-slash&quot;}}&gt;&lt;/i&gt;
            {{#if enabled}}
                Please speak!
            {{else}}
                Click to enable voice control!
            {{/if}}
    &lt;/button&gt;
&lt;/script&gt;
</code></pre><p>The result looks like this:</p><p><a class="jsbin-embed" href="http://jsbin.com/gereja/6/embed??output">Voice Control Component Demo</a><script src="http://static.jsbin.com/js/embed.js"></script></p><p><a href="https://github.com/OrKoN/ember-web-speech-component">Github</a></p><h2>Additional remarks</h2><ul><li>since the web speech API is available in webkit only, it&#39;s a good idea to check whether the user&#39;s browser supports the API</li><li>when the website is accessed over http, the permission to use the microphone will not be remembered by the browser and the user will be asked each time to allow using the microphone.</li></ul><p>Thanks for reading. Please comment and subscribe!</p></article><div class="more-posts"><hr><h2>More Posts</h2><ul><li><a href="http://js-for.ninja/my-observers-do-not-work-or-rtfm.html">Ember.js: My Observers Do Not Work or RTFM</a></li><li><a href="http://js-for.ninja/custom-ember-dev-workflow-using-jspm.html">Custom Build Workflows Using Ember and JSPM</a></li><li><a href="http://js-for.ninja/ember-js-how-to-hide-views-using-is-visible-property.html">Ember.js: How to Hide Views Using IsVisible Property</a></li><li><a href="http://js-for.ninja/ember-js-using-unbound-helpers.html">Ember.JS: Using The Unbound Helper</a></li></ul></div><div id="disqus_thread"></div><script type="text/javascript">/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'jsforninja'; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><meta itemprop="url" content="/ember-js-and-web-speech-api-example.html"></div></div></div><footer class="site-footer"><div class="wrapper"><h2 class="footer-heading">JavaScript for Ninja</h2><div class="footer-col-wrapper"><div class="footer-col footer-col-1"><ul class="contact-list"><li>JavaScript for Ninja</li><li><a href="mailto:contact-us@js-for.ninja">contact-us@js-for.ninja</a></li></ul></div><div class="footer-col footer-col-2"><h6 class="social-media-list-header">Subscribe via</h6><ul class="social-media-list"><li><a href="https://github.com/js-for-ninja"><span class="icon icon--github"><svg viewbox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"></svg></span> <span class="username">js-for-ninja</span></a></li><li><a href="https://twitter.com/js_for_ninja"><span class="icon icon--twitter"><svg viewbox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"></svg></span> <span class="username">js_for_ninja</span></a></li></ul></div><div class="footer-col footer-col-3"><p class="text">JavaScript for Ninja(<a href="/about.html#name">?</a>) is a blog about Web Development and JavaScript.</p></div></div></div><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-57010783-1', 'auto');
      ga('send', 'pageview');</script><script src="/js/main.js" type="text/javascript"></script></footer></body></html>